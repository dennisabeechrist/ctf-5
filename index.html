<!DOCTYPE html>
<html>
<head>
  <title>Session Challenge</title>
  <style>
    body { background:#0d0d0d; color:#0aff9d; font-family:monospace; text-align:center; margin-top:15%; }
    .box { border:1px solid #0aff9d; display:inline-block; padding:20px; border-radius:8px; }
  </style>
</head>
<body>
  <div class="box">
    <h2>Access Restricted</h2>
    <p id="msg">You don't have access.</p>
  </div>

  <script>
    // Always create a default cookie "s" if it doesn't exist
    if (!document.cookie.split('; ').find(row => row.startsWith("s="))) {
      document.cookie = "s=; path=/";
    }

    function getCookie(name) {
      let match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
      return match ? decodeURIComponent(match[2]) : "";
    }

    function decodeFlag(value) {
      // Hidden encoded flag, but not in plaintext
      let hidden = [ 209, 218, 211, 230, 199, 232, 210, 219, 215, 218, 227, 202 ];
      let key = value.length;
      return hidden.map(x => String.fromCharCode(x - key)).join('');
    }

    let val = getCookie("s");
    if (val && val === "darkcode") {   // expected correct value
      document.getElementById("msg").textContent = "Flag: " + decodeFlag(val);
    }
  </script>
</body>
</html>
