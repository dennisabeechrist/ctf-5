<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Session Fixer Challenge</title>
<style>
  body { background:#0f0f0f; color:#00ff99; font-family:monospace; text-align:center; padding-top:80px; }
  .box { background:#1a1a1a; border:2px solid #00ff99; display:inline-block; padding:30px; border-radius:10px; }
  input { margin:10px; padding:5px; width:200px; background:#0f0f0f; border:1px solid #00ff99; color:#00ff99; }
  button { padding:5px 15px; background:#00ff99; color:black; border:none; cursor:pointer; }
  #flag { margin-top:20px; color:#ff3333; font-weight:bold; display:none; }
</style>
</head>
<body>

<div class="box">
  <h1>üîê Session Fixer</h1>
  <p>Login is optional. To unlock the session, solve the puzzle below.</p>
  <p><strong>Puzzle:</strong> Solve <code>(7 √ó 5) + 18</code> and set it as your session cookie.</p>

  <input type="text" id="username" placeholder="Username"><br>
  <input type="password" id="password" placeholder="Password"><br>
  <button onclick="login()">Login</button>

  <div id="status"></div>
  <div id="flag"></div>
</div>

<script>
// --- Encrypted flag: XORed char codes
const encodedFlag = [30,7,14,29,0,12,11,27,14,29,7,30]; // flag{dexter}
const key = 42; // secret key

function decodeFlag() {
    let flag = '';
    for(let i=0;i<encodedFlag.length;i++){
        flag += String.fromCharCode(encodedFlag[i]^key);
    }
    return flag;
}

// Correct cookie value from puzzle calculation
const correctCookie = (7*5)+18; // 35 + 18 = 53

function login() {
    const status = document.getElementById("status");
    const flagDiv = document.getElementById("flag");

    // Check cookie
    const cookies = document.cookie.split(";").map(c => c.trim());
    const sessionCookie = cookies.find(c => c.startsWith("session="));
    if(sessionCookie) {
        const val = parseInt(sessionCookie.split("=")[1]);
        if(val === correctCookie) {
            status.textContent = "Correct session! Here is the flag:";
            flagDiv.textContent = decodeFlag();
            flagDiv.style.display = "block";
            return;
        }
    }

    // Fake login (decoy)
    const user = document.getElementById("username").value;
    const pass = document.getElementById("password").value;
    if(user && pass) {
        status.textContent = "Login failed! Hint: solve the puzzle and set the cookie manually.";
        flagDiv.style.display = "none";
    } else {
        status.textContent = "";
        flagDiv.style.display = "none";
    }
}
</script>

</body>
</html>
