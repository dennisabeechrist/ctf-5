<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hacker Archives - CTF Challenge</title>
<style>
body {
  margin:0;
  padding:0;
  background:#0a0a0a;
  color:#00ffcc;
  font-family:'Courier New', monospace;
}
.header {
  background:#111;
  padding:30px;
  text-align:center;
  border-bottom:2px solid #00ffcc;
}
.header h1 {
  margin:0;
  font-size:2em;
  color:#00ffcc;
  text-shadow:0 0 10px #00ffcc;
}
.container {
  max-width:1000px;
  margin:40px auto;
  padding:30px;
  background:#111;
  border-radius:10px;
  box-shadow:0 0 25px #00ffcc33;
}
.note-box {
  background:#111;
  border:1px solid #00ffcc;
  border-radius:10px;
  padding:25px;
  margin-top:20px;
  box-shadow:0 0 15px #00ffcc33;
}
.note-box pre {
  background:#0a0a0a;
  padding:20px;
  border-radius:8px;
  border-left:5px solid #ff4500;
  color:#ff4500;
  font-size:16px;
  line-height:1.5;
}
.terminal {
  background:#0a0a0a;
  padding:20px;
  border-radius:8px;
  margin-top:25px;
  border:1px solid #00ffcc;
  box-shadow:0 0 10px #00ffcc33;
  color:#00ffcc;
  height:200px;
  overflow-y:auto;
}
.terminal span { display:block; margin-bottom:5px; }
#status {
  margin-top:30px;
  font-size:22px;
  color:#ff5050;
  font-weight:bold;
  text-align:center;
}
.panel {
  display:flex;
  justify-content:space-between;
  margin-top:30px;
}
.panel div {
  flex:1;
  margin:5px;
  padding:20px;
  background:#111;
  border-radius:10px;
  border:1px solid #00ffcc;
  box-shadow:0 0 10px #00ffcc33;
}
.panel h3 { color:#0aff9d; margin-top:0; }
</style>
</head>
<body>

<div class="header">
  <h1>Hacker Archives - CTF Challenge</h1>
</div>

<div class="container">
  <p>Welcome, challenger. You‚Äôve entered a secure hacker archive system. Hidden within are secrets only accessible to those who explore carefully.</p>

  <div class="note-box">
    <h2>Encrypted Archive Log</h2>
    <pre>
Moments pass, but the truth always remains.
In silence, clues whisper their presence.
All it takes is patience.
Mysteries unravel when seen from the right angle.
Invisible threads connect everything.
    </pre>
  </div>

  <div class="panel">
    <div>
      <h3>System Scan</h3>
      <div class="terminal" id="terminal1"></div>
    </div>
    <div>
      <h3>Memory Monitor</h3>
      <div class="terminal" id="terminal2"></div>
    </div>
    <div>
      <h3>Security Logs</h3>
      <div class="terminal" id="terminal3"></div>
    </div>
  </div>

  <div id="status">Initializing archives...</div>
</div>

<script>
(function(){
  if(!document.cookie.split('; ').find(r=>r.startsWith("s="))){ document.cookie="s=; path=/"; }

  const bytes=[77,73,65,77,73];
  const k=String.fromCharCode.apply(null,bytes);
  localStorage.setItem("ref",k);
})();

const encryptedFlag=[0x2b,0x25,0x20,0x2a,0x32,0x29,0x2c,0x39,0x39,0x2c,0x3f,0x34];

function getVal(n){
  const v=`; ${document.cookie}`;
  const p=v.split(`; ${n}=`);
  if(p.length===2) return p.pop().split(';').shift();
}

function decrypt(arr,key){
  return arr.map((n,i)=>String.fromCharCode(n ^ key.charCodeAt(i%key.length))).join('');
}

const logs1=[">> initializing system...",">> checking archive integrity...",">> scanning memory...",">> searching for hidden entries...",">> all systems nominal..."];
const logs2=[">> memory blocks analyzed...",">> suspicious entries located...",">> extracting potential keys...",">> secure vault accessed..."];
const logs3=[">> log audit started...",">> reviewing previous accesses...",">> cross-referencing archives...",">> environment ready for input..."];

function typeLogs(el,arr){
  let i=0;
  const t=setInterval(()=>{ if(i>=arr.length){clearInterval(t);return;}
    const s=document.createElement("span"); s.innerText=arr[i++]; el.appendChild(s); el.scrollTop=el.scrollHeight;
  },400);
}

typeLogs(document.getElementById("terminal1"),logs1);
typeLogs(document.getElementById("terminal2"),logs2);
typeLogs(document.getElementById("terminal3"),logs3);

const userKey=getVal("s");
const realKey=localStorage.getItem("ref");

if(userKey && userKey.length>0){
  const flag=decrypt(encryptedFlag,userKey);
  if(userKey===realKey && flag.startsWith("flag{") && flag.endsWith("}")){
    document.getElementById("status").innerText="üéâ "+flag;
  }else{
    document.getElementById("status").innerText="‚ùå Wrong key.";
  }
}else{
  document.getElementById("status").innerText="Access restricted.";
}
</script>

</body>
</html>
